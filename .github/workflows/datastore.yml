name: Run DataStore Script

on:
  schedule:
    # Runs at 9:29 AM IST (3:59 AM UTC) daily
    - cron: '59 3 * * *'
  workflow_dispatch:

jobs:
  run-datastore:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install yfinance 0.2.61
        run: pip install yfinance==0.2.61

      - name: Run DataStore.py with rate-limit friendly settings
        run: |
          echo "Starting DataStore.py download..."
          python DataStore.py
        timeout-minutes: 2
        continue-on-error: true

      - name: Verify results
        run: |
          if [ -d "results_pkl" ]; then
            echo "Results directory exists"
            ls -lh results_pkl/
          else
            echo "Warning: results_pkl directory not found"
          fi

